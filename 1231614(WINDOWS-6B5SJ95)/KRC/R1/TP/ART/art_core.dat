&ACCESS RVO2
&REL 1030
&PARAM DISKPATH = KRC:\R1\TP\ART
DEFDAT  art_core PUBLIC

GLOBAL ENUM ART_MOTION_TYPE ARTMotionGoHome,ARTMotionGoService,ARTMotionMainCycle,ARTMotionEndCycle,ARTMotionNone
GLOBAL ENUM ART_MOTION_POSITION ARTMotionPosHome,ARTMotionPosService,ARTMotionPosSafe,ARTMotionPosUnknown
GLOBAL ENUM ARTSYS_STATE_TYPE ARTSYS_STATE_NORMAL,ARTSYS_STATE_STARTING,ARTSYS_STATE_STOPPED,ARTSYS_STATE_WARNING,ARTSYS_STATE_ERROR,ARTSYS_STATE_CRITICAL ;,ARTSYS_STATE_EXTSTOP
GLOBAL ENUM ART_DEVICE_STATE NORMAL, WARNING, ERROR
ENUM HMI_TYPE INTERNAL,EXTERNAL
; System state.
DECL GLOBAL ARTSYS_STATE_TYPE ARTSystemState=#ARTSYS_STATE_WARNING
DECL GLOBAL ARTSYS_STATE_TYPE ARTSystemStateNew=#ARTSYS_STATE_NORMAL
DECL BOOL start_state_confirm=FALSE
DECL BOOL start_state_pressed=FALSE
; Motion state.
DECL GLOBAL ART_MOTION_TYPE ARTControlMotionCmd=#ARTMotionMainCycle
; Interrupt number for motion control.
DECL INT ARTHMISavedOVPro=30

DECL GLOBAL BOOL ARTHMIBlinkLong=TRUE
DECL GLOBAL BOOL ARTHMIBlinkShort=FALSE
DECL BOOL ARTHMIWarningSound=FALSE
DECL BOOL ARTHMIErrorSound=FALSE
DECL INT ARTHMIWarningTimer=878395
DECL INT ARTHMIConfirmTimer=0
DECL INT ARTSystemStartTimer=0
DECL INT ARTSystemStateTimer=880377
DECL INT DEF_SYS_UPDATE_RATE=300
DECL INT DEF_SYS_START_RATE=5000
DECL INT DEF_SYS_CONFIRM_RESET=60000
; HMI PC BUTTONS VAR
DECL GLOBAL BOOL ART_START_PUSHED=FALSE
DECL GLOBAL BOOL ART_RESET_PUSHED=FALSE
DECL GLOBAL BOOL ART_STOP_PUSHED=FALSE
; Version.
DECL GLOBAL CHAR ARTSystemVersion[80]
ARTSystemVersion[]="ARTech CS V3.02 Build 001"

DECL GLOBAL INT EXT_OUT_MSG=0 ; 

;DECL BOOL ARTControlIsCycleON=TRUE
; 
; Test key numbers.
; 
DECL GLOBAL CONST INT DEF_START_KN=14
DECL GLOBAL CONST INT DEF_RESET_KN=15
DECL GLOBAL CONST INT DEF_WA1_READY_KN=16
DECL GLOBAL CONST INT DEF_WA2_READY_KN=17
;DECL GLOBAL CONST INT DEF_PP_READY_KN=1000
;DECL GLOBAL CONST INT DEF_WA1_BARRIER_KN=1000
;DECL GLOBAL CONST INT DEF_WA2_BARRIER_KN=1000
DECL GLOBAL CONST INT DEF_STOP_KN=1000


; Massages handler.
DECL INT m_handleErrStopped=0
DECL INT m_handleErrStopmess=0
DECL INT m_handleErrProgram=0
DECL INT m_handleErrAir=0
DECL GLOBAL INT m_ext_emergency_stop=0
; Messages array.
DECL GLOBAL CHAR ARTSystemErrMsg[160]
STRUC ART_MESSAGE CHAR msgModule[256],CHAR msgKey[256],INT handle
DECL GLOBAL INT ART_DEF_LIST_SIZE=150
DECL ART_MESSAGE ARTMessagesList[150]
DECL GLOBAL INT ART_messages_count=0
; Errs.
DECL GLOBAL INT MOVE_INTERRUPT
DECL GLOBAL CONST INT ERR_OK=0
DECL GLOBAL CONST INT ERR_INTERRUPT=-1
DECL GLOBAL CONST INT ERR_INIT_FAILED=-2
DECL GLOBAL CONST INT ERR_POWER_FAILURE=-3

; Robot log vars.
DECL GLOBAL INT ART_LogMotionPutTime=0
DECL GLOBAL INT ART_LogMotionGetTime=0
DECL GLOBAL INT ART_LogMotionTimer=0
DECL GLOBAL BOOL ART_LogMotionPutTimeF=TRUE
DECL GLOBAL BOOL ART_LogMotionGetTimeF=FALSE
DECL GLOBAL INT ART_LogStandedTime=0
DECL INT ART_LogStoppedTimer=0
DECL GLOBAL BOOL ART_LogStandedTimeF=FALSE
DECL GLOBAL INT ART_LogMovedTime=0
DECL INT ART_LogMovedTimer=0
DECL GLOBAL BOOL ART_LogMovedTimeF=FALSE
DECL GLOBAL REAL ART_LogTorque[6]
DECL INT cur_logged_torque=1
DECL GLOBAL INT ART_LogTemperature
DECL GLOBAL INT ART_LogSysErr


DECL INT m_hmiBlinkCount=3
DECL GLOBAL CONST INT DEF_BLINK_INNUM=19

;DECL GLOBAL ART_MOTION_POSITION ARTControlMotionPosition=#ARTMotionPosUnknown
;DECL HMI_TYPE DEF_HMI_TYPE=#INTERNAL
;DECL HMI_TYPE DEF_HMI_TYPE=#EXTERNAL
ENDDAT
